colors()
Snitt <- colorRamp(c("grey", "yellowgreen"))(rmn[labels(dend)]) %>% rgb(maxColorValue=255)
dend %>%#
  set("labels_cex", 0.15) %>%#
  set("branches_lwd", 0.4) %>%#
  set("branches_k_color", k=4) %>%#
  raise.dendrogram (0.6) %>%#
  plot#
rmn <- tt2[,] %>% #
  data.matrix %>% #
  apply(1, median, na.rm=TRUE)#
#
rmn <- rmn - min(rmn)#
rmn <- rmn / max(rmn)#
#
Kjønn <- c("grey10", "purple", "lightblue")[tt[labels(dend), "Kj"]]#
Trinn <- rainbow(5, end=0.15)[tt[labels(dend), "Trinn"]]#
Snitt <- colorRamp(c("grey", "yellowgreen"))(rmn[labels(dend)]) %>% rgb(maxColorValue=255)#
#
colored_bars(cbind(Kjønn, Trinn, Snitt), dend=dend, y_shift=-5, cex=0.5)
colors()
dend %>%#
  set("labels_cex", 0.15) %>%#
  set("branches_lwd", 0.4) %>%#
  set("branches_k_color", k=4) %>%#
  raise.dendrogram (0.6) %>%#
  plot#
rmn <- tt2[,] %>% #
  data.matrix %>% #
  apply(1, median, na.rm=TRUE)#
#
rmn <- rmn - min(rmn)#
rmn <- rmn / max(rmn)#
#
Kjønn <- c("grey10", "purple", "lightblue")[tt[labels(dend), "Kj"]]#
Trinn <- rainbow(5, end=0.15)[tt[labels(dend), "Trinn"]]#
Snitt <- colorRamp(c("grey", "springgreen"))(rmn[labels(dend)]) %>% rgb(maxColorValue=255)#
#
colored_bars(cbind(Kjønn, Trinn, Snitt), dend=dend, y_shift=-5, cex=0.5)
colors()
grep("green", colors())
colors()[grep("green", colors())]
dend %>%#
  set("labels_cex", 0.15) %>%#
  set("branches_lwd", 0.4) %>%#
  set("branches_k_color", k=4) %>%#
  raise.dendrogram (0.6) %>%#
  plot#
rmn <- tt2[,] %>% #
  data.matrix %>% #
  apply(1, median, na.rm=TRUE)#
#
rmn <- rmn - min(rmn)#
rmn <- rmn / max(rmn)#
#
Kjønn <- c("grey10", "purple", "lightblue")[tt[labels(dend), "Kj"]]#
Trinn <- rainbow(5, end=0.15)[tt[labels(dend), "Trinn"]]#
Snitt <- colorRamp(c("grey", "forestgreen"))(rmn[labels(dend)]) %>% rgb(maxColorValue=255)#
#
colored_bars(cbind(Kjønn, Trinn, Snitt), dend=dend, y_shift=-5, cex=0.5)
dend %>%#
  set("labels_cex", 0.15) %>%#
  set("branches_lwd", 0.4) %>%#
  set("branches_k_color", k=4) %>%#
  raise.dendrogram (0.6) %>%#
  plot#
rmn <- tt2[,] %>% #
  data.matrix %>% #
  apply(1, median, na.rm=TRUE)#
#
rmn <- rmn - min(rmn)#
rmn <- rmn / max(rmn)#
#
Kjønn <- c("grey10", "purple", "lightblue")[tt[labels(dend), "Kj"]]#
Trinn <- rainbow(5, end=0.15)[tt[labels(dend), "Trinn"]]#
Snitt <- colorRamp(c("lightgrey", "forestgreen"))(rmn[labels(dend)]) %>% rgb(maxColorValue=255)#
#
colored_bars(cbind(Kjønn, Trinn, Snitt), dend=dend, y_shift=-5, cex=0.5)
quartz.save("tree.pdf", type="pdf")
dend %>%#
  set("labels_cex", 0.15) %>%#
  set("branches_lwd", 0.4) %>%#
  set("branches_k_color", k=4) %>%#
  raise.dendrogram (0.6) %>%#
  plot#
rmn <- tt2[,] %>% #
  data.matrix %>% #
  apply(1, mean, na.rm=TRUE)#
#
rmn <- rmn - min(rmn)#
rmn <- rmn / max(rmn)#
#
Kjønn <- c("grey10", "purple", "lightblue")[tt[labels(dend), "Kj"]]#
Trinn <- rainbow(5, end=0.15)[tt[labels(dend), "Trinn"]]#
Snitt <- colorRamp(c("lightgrey", "forestgreen"))(rmn[labels(dend)]) %>% rgb(maxColorValue=255)#
#
colored_bars(cbind(Kjønn, Trinn, Snitt), dend=dend, y_shift=-5, cex=0.5)#
#
quartz.save("tree.pdf", type="pdf")
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifagene\""),#
  sidebarLayout(#
    sidebarPanel(#
      h5("Skole"),#
      tags$div(class="multicol", #
        checkboxGroupInput(inputId="skole",#
          label=NULL,#
          choiceNames=levels(dat$Skole),#
          choiceValues=levels(dat$Skole),#
          selected=levels(dat$Skole),#
          inline=FALSE#
        )#
      ),#
      h5("Trinn"),#
      checkboxGroupInput(inputId="trinn",#
        label=NULL,#
        choiceNames=levels(dat$Trinn),#
        choiceValues=levels(dat$Trinn),#
        selected=levels(dat$Trinn),#
        inline=TRUE#
      ),#
      h5("Klasse"),#
      tags$div(class="multicol", #
        checkboxGroupInput(inputId="klasse",#
          label=NULL,#
          choiceNames=levels(dat$Klasse),#
          choiceValues=levels(dat$Klasse),#
          selected=levels(dat$Klasse),#
          inline=FALSE#
        )#
      ),#
      h5("Kjønn"),#
      checkboxGroupInput(inputId="kjønn",#
        label=NULL,#
        choiceNames=nam(dat$Kj),#
        choiceValues=val(dat$Kj),#
        selected=val(dat$Kj),#
        inline=TRUE#
      ),#
      h5("Fødselsår"),#
      tags$div(class="multicol", #
        checkboxGroupInput(inputId="år",#
          label=NULL,#
          choiceNames=nam(dat$F.aar),#
          choiceValues=val(dat$F.aar),#
          selected=val(dat$F.aar),#
          inline=FALSE#
        )#
      ),#
      h5("Fødselsmåned"),#
      tags$div(class="multicol", #
        checkboxGroupInput(inputId="mnd",#
          label=NULL,#
          choiceNames=nam(dat$F.mnd),#
          choiceValues=val(dat$F.mnd),#
          selected=val(dat$F.mnd),#
          inline=FALSE#
        )#
      ),#
      h5("Velg responsvariabler [1, 61]"),#
      textInput(inputId="spm", #
        label=NULL, #
        value="1, 3:5, 7, 9"#
      ),#
      textOutput("txt")#
    ),#
    mainPanel(#
        plotOutput("hist")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
#
    z <- paste0("c(", input$spm, ")")#
    z <- eval(parse(text=z))#
    spm <- paste0("X", z)#
    sel <- dat[#
      dat$Skole %in% c(input$skole) & #
      dat$Trinn %in% c(input$trinn) & #
      dat$Klasse %in% c(input$klasse) & #
      dat$Kj %in% c(input$kjønn) & #
      dat$F.aar %in% c(input$år) & #
      dat$F.mnd %in% c(input$mnd),#
      spm, drop=FALSE]#
    barplot(prop.table(table(unlist(sel))), density=20, col="grey95", space=2/3)#
  })#
  output$txt <- renderPrint({#
    print("…")#
  })#
}#
shinyApp(ui = ui, server = server)
setwd("~/Documents/R/shiny/bioint")
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifagene\""),#
  sidebarLayout(#
    sidebarPanel(#
      h5("Skole"),#
      tags$div(class="multicol", #
        checkboxGroupInput(inputId="skole",#
          label=NULL,#
          choiceNames=levels(dat$Skole),#
          choiceValues=levels(dat$Skole),#
          selected=levels(dat$Skole),#
          inline=FALSE#
        )#
      ),#
      h5("Trinn"),#
      checkboxGroupInput(inputId="trinn",#
        label=NULL,#
        choiceNames=levels(dat$Trinn),#
        choiceValues=levels(dat$Trinn),#
        selected=levels(dat$Trinn),#
        inline=TRUE#
      ),#
      h5("Klasse"),#
      tags$div(class="multicol", #
        checkboxGroupInput(inputId="klasse",#
          label=NULL,#
          choiceNames=levels(dat$Klasse),#
          choiceValues=levels(dat$Klasse),#
          selected=levels(dat$Klasse),#
          inline=FALSE#
        )#
      ),#
      h5("Kjønn"),#
      checkboxGroupInput(inputId="kjønn",#
        label=NULL,#
        choiceNames=nam(dat$Kj),#
        choiceValues=val(dat$Kj),#
        selected=val(dat$Kj),#
        inline=TRUE#
      ),#
      h5("Fødselsår"),#
      tags$div(class="multicol", #
        checkboxGroupInput(inputId="år",#
          label=NULL,#
          choiceNames=nam(dat$F.aar),#
          choiceValues=val(dat$F.aar),#
          selected=val(dat$F.aar),#
          inline=FALSE#
        )#
      ),#
      h5("Fødselsmåned"),#
      tags$div(class="multicol", #
        checkboxGroupInput(inputId="mnd",#
          label=NULL,#
          choiceNames=nam(dat$F.mnd),#
          choiceValues=val(dat$F.mnd),#
          selected=val(dat$F.mnd),#
          inline=FALSE#
        )#
      ),#
      h5("Velg responsvariabler [1, 61]"),#
      textInput(inputId="spm", #
        label=NULL, #
        value="1, 3:5, 7, 9"#
      ),#
      textOutput("txt")#
    ),#
    mainPanel(#
        plotOutput("hist")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
#
    z <- paste0("c(", input$spm, ")")#
    z <- eval(parse(text=z))#
    spm <- paste0("X", z)#
    sel <- dat[#
      dat$Skole %in% c(input$skole) & #
      dat$Trinn %in% c(input$trinn) & #
      dat$Klasse %in% c(input$klasse) & #
      dat$Kj %in% c(input$kjønn) & #
      dat$F.aar %in% c(input$år) & #
      dat$F.mnd %in% c(input$mnd),#
      spm, drop=FALSE]#
    barplot(prop.table(table(unlist(sel))), density=20, col="grey95", space=2/3)#
  })#
  output$txt <- renderPrint({#
    print("…")#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifagene\""),#
  sidebarLayout(#
    sidebarPanel(#
      h5("Skole"),#
      tags$div(class="multicol", #
        checkboxGroupInput(inputId="skole",#
          label=NULL,#
          choiceNames=levels(dat$Skole),#
          choiceValues=levels(dat$Skole),#
          selected=levels(dat$Skole),#
          inline=FALSE#
        )#
      ),#
      h5("Trinn"),#
      checkboxGroupInput(inputId="trinn",#
        label=NULL,#
        choiceNames=levels(dat$Trinn),#
        choiceValues=levels(dat$Trinn),#
        selected=levels(dat$Trinn),#
        inline=TRUE#
      ),#
      h5("Klasse"),#
      tags$div(class="multicol", #
        checkboxGroupInput(inputId="klasse",#
          label=NULL,#
          choiceNames=levels(dat$Klasse),#
          choiceValues=levels(dat$Klasse),#
          selected=levels(dat$Klasse),#
          inline=FALSE#
        )#
      ),#
      h5("Kjønn"),#
      checkboxGroupInput(inputId="kjønn",#
        label=NULL,#
        choiceNames=nam(dat$Kj),#
        choiceValues=val(dat$Kj),#
        selected=val(dat$Kj),#
        inline=TRUE#
      ),#
      h5("Fødselsår"),#
      tags$div(class="multicol", #
        checkboxGroupInput(inputId="år",#
          label=NULL,#
          choiceNames=nam(dat$F.aar),#
          choiceValues=val(dat$F.aar),#
          selected=val(dat$F.aar),#
          inline=FALSE#
        )#
      ),#
      h5("Fødselsmåned"),#
      tags$div(class="multicol", #
        checkboxGroupInput(inputId="mnd",#
          label=NULL,#
          choiceNames=nam(dat$F.mnd),#
          choiceValues=val(dat$F.mnd),#
          selected=val(dat$F.mnd),#
          inline=FALSE#
        )#
      ),#
      h5("Velg responsvariabler [1, 61]"),#
      textInput(inputId="spm", #
        label=NULL, #
        value="1, 3:5, 7, 9"#
      ),#
      textOutput("txt")#
    ),#
    mainPanel(#
        plotOutput("hist")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
#
    z <- paste0("c(", input$spm, ")")#
    z <- eval(parse(text=z))#
    spm <- paste0("X", z)#
    sel <- dat[#
      dat$Skole %in% c(input$skole) & #
      dat$Trinn %in% c(input$trinn) & #
      dat$Klasse %in% c(input$klasse) & #
      dat$Kj %in% c(input$kjønn) & #
      dat$F.aar %in% c(input$år) & #
      dat$F.mnd %in% c(input$mnd),#
      spm, drop=FALSE]#
    barplot(prop.table(table(unlist(sel))), density=20, col="grey95", space=2/3)#
  })#
  output$txt <- renderPrint({#
    print("…")#
  })#
}#
shinyApp(ui = ui, server = server)
dend <- tt[, -c(1:8)] %>% #
  data.matrix %>% #
  daisy("man") %>%#
  hclust("ward.D2") %>% #
  as.dendrogram#
#
dend %>%#
  set("labels_cex", 0.15) %>%#
  set("branches_lwd", 0.4) %>%#
  set("branches_k_color", k=4) %>%#
  raise.dendrogram (0.6) %>%#
  plot#
rmn <- tt2[,] %>% #
  data.matrix %>% #
  apply(1, mean, na.rm=TRUE)#
#
rmn <- rmn - min(rmn)#
rmn <- rmn / max(rmn)#
#
Kjønn <- c("grey10", "purple", "lightblue")[tt[labels(dend), "Kj"]]#
Trinn <- rainbow(5, end=0.15)[tt[labels(dend), "Trinn"]]#
Snitt <- colorRamp(c("lightgrey", "forestgreen"))(rmn[labels(dend)]) %>% rgb(maxColorValue=255)#
#
colored_bars(cbind(Kjønn, Trinn, Snitt), dend=dend, y_shift=-5, cex=0.5)
colored_bars(cbind(Kjønn, Trinn, Snitt), dend=dend, y_shift=-9, cex=0.5)
dend %>%#
  set("labels_cex", 0.15) %>%#
  set("branches_lwd", 0.4) %>%#
  set("branches_k_color", k=4) %>%#
  raise.dendrogram (0.6) %>%#
  plot#
rmn <- tt2[,] %>% #
  data.matrix %>% #
  apply(1, mean, na.rm=TRUE)#
#
rmn <- rmn - min(rmn)#
rmn <- rmn / max(rmn)#
#
Kjønn <- c("grey10", "purple", "lightblue")[tt[labels(dend), "Kj"]]#
Trinn <- rainbow(5, end=0.15)[tt[labels(dend), "Trinn"]]#
Snitt <- colorRamp(c("lightgrey", "forestgreen"))(rmn[labels(dend)]) %>% rgb(maxColorValue=255)#
#
colored_bars(cbind(Kjønn, Trinn, Snitt), dend=dend, y_shift=-9, cex=0.5)#
#
quartz.save("tree.pdf", type="pdf")
dend %>%#
  set("labels_cex", 0.15) %>%#
  set("branches_lwd", 0.4) %>%#
  set("branches_k_color", k=4) %>%#
  raise.dendrogram (0.6) %>%#
  plot#
rmn <- tt2[,] %>% #
  data.matrix %>% #
  apply(1, mean, na.rm=TRUE)#
#
rmn <- rmn - min(rmn)#
rmn <- rmn / max(rmn)#
#
Kjønn <- c("grey10", "purple", "lightblue")[tt[labels(dend), "Kj"]]#
Trinn <- rainbow(5, end=0.15)[tt[labels(dend), "Trinn"]]#
Snitt <- colorRamp(c("lightgrey", "forestgreen"))(rmn[labels(dend)]) %>% rgb(maxColorValue=255)#
#
colored_bars(cbind(Kjønn, Trinn, Snitt), dend=dend, y_shift=-13, cex=0.5)#
#
quartz.save("tree.pdf", type="pdf")
dend <- tt[, -c(1:8)] %>% #
  data.matrix %>% #
  daisy("man") %>%#
  hclust("average") %>% #
  as.dendrogram#
#
dend %>%#
  set("labels_cex", 0.15) %>%#
  set("branches_lwd", 0.4) %>%#
  set("branches_k_color", k=4) %>%#
  raise.dendrogram (0.6) %>%#
  plot#
rmn <- tt2[,] %>% #
  data.matrix %>% #
  apply(1, mean, na.rm=TRUE)#
#
rmn <- rmn - min(rmn)#
rmn <- rmn / max(rmn)#
#
Kjønn <- c("grey10", "purple", "lightblue")[tt[labels(dend), "Kj"]]#
Trinn <- rainbow(5, end=0.15)[tt[labels(dend), "Trinn"]]#
Snitt <- colorRamp(c("lightgrey", "forestgreen"))(rmn[labels(dend)]) %>% rgb(maxColorValue=255)#
#
colored_bars(cbind(Kjønn, Trinn, Snitt), dend=dend, y_shift=-13, cex=0.5)
colored_bars(cbind(Kjønn, Trinn, Snitt), dend=dend, y_shift=-3, cex=0.5)
dend %>%#
  set("labels_cex", 0.15) %>%#
  set("branches_lwd", 0.4) %>%#
  set("branches_k_color", k=4) %>%#
  raise.dendrogram (0.6) %>%#
  plot#
rmn <- tt2[,] %>% #
  data.matrix %>% #
  apply(1, mean, na.rm=TRUE)#
#
rmn <- rmn - min(rmn)#
rmn <- rmn / max(rmn)#
#
Kjønn <- c("grey10", "purple", "lightblue")[tt[labels(dend), "Kj"]]#
Trinn <- rainbow(5, end=0.15)[tt[labels(dend), "Trinn"]]#
Snitt <- colorRamp(c("lightgrey", "forestgreen"))(rmn[labels(dend)]) %>% rgb(maxColorValue=255)#
#
colored_bars(cbind(Kjønn, Trinn, Snitt), dend=dend, y_shift=-3, cex=0.5)#
#
quartz.save("tree.pdf", type="pdf")
dend <- tt[, -c(1:8)] %>% #
  data.matrix %>% #
  daisy("man") %>%#
  hclust("complete") %>% #
  as.dendrogram#
#
dend %>%#
  set("labels_cex", 0.15) %>%#
  set("branches_lwd", 0.4) %>%#
  set("branches_k_color", k=4) %>%#
  raise.dendrogram (0.6) %>%#
  plot#
rmn <- tt2[,] %>% #
  data.matrix %>% #
  apply(1, mean, na.rm=TRUE)#
#
rmn <- rmn - min(rmn)#
rmn <- rmn / max(rmn)#
#
Kjønn <- c("grey10", "purple", "lightblue")[tt[labels(dend), "Kj"]]#
Trinn <- rainbow(5, end=0.15)[tt[labels(dend), "Trinn"]]#
Snitt <- colorRamp(c("lightgrey", "forestgreen"))(rmn[labels(dend)]) %>% rgb(maxColorValue=255)#
#
colored_bars(cbind(Kjønn, Trinn, Snitt), dend=dend, y_shift=-5, cex=0.5)#
#
quartz.save("tree.pdf", type="pdf")#
#
# colors()[grep("green", colors())]#
# colnames(tt[1:8])#
# tt[,"Trinn"]
dend %>%#
  set("labels_cex", 0.15) %>%#
  set("branches_lwd", 0.4) %>%#
  set("branches_k_color", k=4) %>%#
  raise.dendrogram (0.6) %>%#
  plot#
rmn <- tt2[,] %>% #
  data.matrix %>% #
  apply(1, mean, na.rm=TRUE)#
#
rmn <- rmn - min(rmn)#
rmn <- rmn / max(rmn)#
#
Kjønn <- c("grey10", "purple", "lightblue")[tt[labels(dend), "Kj"]]#
Trinn <- rainbow(5, end=0.15)[tt[labels(dend), "Trinn"]]#
Snitt <- colorRamp(c("white", "forestgreen"))(rmn[labels(dend)]) %>% rgb(maxColorValue=255)#
#
colored_bars(cbind(Kjønn, Trinn, Snitt), dend=dend, y_shift=-5, cex=0.5)#
#
quartz.save("tree.pdf", type="pdf")
library(rsconnect)
deployApp("~/Documents/R/shiny/bioint")
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifagene\""),#
  sidebarLayout(#
    sidebarPanel(#
    tabsetPanel(#
    tabPanel("tab 1",#
      h5("Skole"),#
      tags$div(class="multicol", #
        checkboxGroupInput(inputId="skole",#
          label=NULL,#
          choiceNames=levels(dat$Skole),#
          choiceValues=levels(dat$Skole),#
          selected=levels(dat$Skole),#
          inline=FALSE#
        )#
      ),#
      h5("Trinn"),#
      checkboxGroupInput(inputId="trinn",#
        label=NULL,#
        choiceNames=levels(dat$Trinn),#
        choiceValues=levels(dat$Trinn),#
        selected=levels(dat$Trinn),#
        inline=TRUE#
      ),#
      h5("Klasse"),#
      tags$div(class="multicol", #
        checkboxGroupInput(inputId="klasse",#
          label=NULL,#
          choiceNames=levels(dat$Klasse),#
          choiceValues=levels(dat$Klasse),#
          selected=levels(dat$Klasse),#
          inline=FALSE#
        )#
      ),#
      h5("Kjønn"),#
      checkboxGroupInput(inputId="kjønn",#
        label=NULL,#
        choiceNames=nam(dat$Kj),#
        choiceValues=val(dat$Kj),#
        selected=val(dat$Kj),#
        inline=TRUE#
      ),#
      h5("Fødselsår"),#
      tags$div(class="multicol", #
        checkboxGroupInput(inputId="år",#
          label=NULL,#
          choiceNames=nam(dat$F.aar),#
          choiceValues=val(dat$F.aar),#
          selected=val(dat$F.aar),#
          inline=FALSE#
        )#
      ),#
      h5("Fødselsmåned"),#
      tags$div(class="multicol", #
        checkboxGroupInput(inputId="mnd",#
          label=NULL,#
          choiceNames=nam(dat$F.mnd),#
          choiceValues=val(dat$F.mnd),#
          selected=val(dat$F.mnd),#
          inline=FALSE#
        )#
      ),#
      h5("Velg responsvariabler [1, 61]"),#
      textInput(inputId="spm", #
        label=NULL, #
        value="1, 3:5, 7, 9"#
      ),#
      textOutput("txt")#
    ))),#
    mainPanel(#
        plotOutput("hist")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
#
    z <- paste0("c(", input$spm, ")")#
    z <- eval(parse(text=z))#
    spm <- paste0("X", z)#
    sel <- dat[#
      dat$Skole %in% c(input$skole) & #
      dat$Trinn %in% c(input$trinn) & #
      dat$Klasse %in% c(input$klasse) & #
      dat$Kj %in% c(input$kjønn) & #
      dat$F.aar %in% c(input$år) & #
      dat$F.mnd %in% c(input$mnd),#
      spm, drop=FALSE]#
    barplot(prop.table(table(unlist(sel))), density=20, col="grey95", space=2/3)#
  })#
  output$txt <- renderPrint({#
    print("…")#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifagene\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        tabPanel("tab 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          ),#
          textOutput("txt")#
        )#
      ),#
        tabPanel("tab 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          ),#
          textOutput("txt")#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
#
    z <- paste0("c(", input$spm, ")")#
    z <- eval(parse(text=z))#
    spm <- paste0("X", z)#
    sel <- dat[#
      dat$Skole %in% c(input$skole) & #
      dat$Trinn %in% c(input$trinn) & #
      dat$Klasse %in% c(input$klasse) & #
      dat$Kj %in% c(input$kjønn) & #
      dat$F.aar %in% c(input$år) & #
      dat$F.mnd %in% c(input$mnd),#
      spm, drop=FALSE]#
    barplot(prop.table(table(unlist(sel))), density=20, col="grey95", space=2/3)#
  })#
  output$txt <- renderPrint({#
    print("…")#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifagene\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        tabPanel("tab 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          ),#
          textOutput("txt")#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
#
    z <- paste0("c(", input$spm, ")")#
    z <- eval(parse(text=z))#
    spm <- paste0("X", z)#
    sel <- dat[#
      dat$Skole %in% c(input$skole) & #
      dat$Trinn %in% c(input$trinn) & #
      dat$Klasse %in% c(input$klasse) & #
      dat$Kj %in% c(input$kjønn) & #
      dat$F.aar %in% c(input$år) & #
      dat$F.mnd %in% c(input$mnd),#
      spm, drop=FALSE]#
    barplot(prop.table(table(unlist(sel))), density=20, col="grey95", space=2/3)#
  })#
  output$txt <- renderPrint({#
    print("…")#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifagene\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        tabPanel("tab 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          ),#
          textOutput("txt")#
        ),#
        tabPanel("tab 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          ),#
          textOutput("txt")#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
#
    z <- paste0("c(", input$spm, ")")#
    z <- eval(parse(text=z))#
    spm <- paste0("X", z)#
    sel <- dat[#
      dat$Skole %in% c(input$skole) & #
      dat$Trinn %in% c(input$trinn) & #
      dat$Klasse %in% c(input$klasse) & #
      dat$Kj %in% c(input$kjønn) & #
      dat$F.aar %in% c(input$år) & #
      dat$F.mnd %in% c(input$mnd),#
      spm, drop=FALSE]#
    barplot(prop.table(table(unlist(sel))), density=20, col="grey95", space=2/3)#
  })#
  output$txt <- renderPrint({#
    print("…")#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifagene\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        tabPanel("tab 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          ),#
          textOutput("txt")#
        ),#
        tabPanel("tab 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          ),#
          textOutput("txt")#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
#
    z <- paste0("c(", input$spm, ")")#
    z <- eval(parse(text=z))#
    spm <- paste0("X", z)#
    sel <- dat[#
      dat$Skole %in% c(input$skole) & #
      dat$Trinn %in% c(input$trinn) & #
      dat$Klasse %in% c(input$klasse) & #
      dat$Kj %in% c(input$kjønn) & #
      dat$F.aar %in% c(input$år) & #
      dat$F.mnd %in% c(input$mnd),#
      spm, drop=FALSE]#
    barplot(prop.table(table(unlist(sel))), density=20, col="grey95", space=2/3)#
  })#
  output$txt <- renderPrint({#
    print("…")#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifagene\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(      #
        tabPanel("tab 1",#
          textInput(inputId="spm11", #
            label="en", #
            value="1, 3:5, 7, 9"#
          ),#
          textInput(inputId="spm12", #
            label="to", #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        tabPanel("tab 2",#
          textInput(inputId="spm21", #
            label="en", #
            value="1, 3:5, 7, 9"#
          ),#
          textInput(inputId="spm22", #
            label="to", #
            value="1, 3:5, 7:8"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    plot(1)#
    legend("topleft", legend=paste("spm11:", spm11))#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifagene\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(      #
        tabPanel("tab 1",#
          textInput(inputId="spm11", #
            label="en", #
            value="1, 3:5, 7, 9"#
          ),#
          textInput(inputId="spm12", #
            label="to", #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        tabPanel("tab 2",#
          textInput(inputId="spm21", #
            label="en", #
            value="1, 3:5, 7, 9"#
          ),#
          textInput(inputId="spm22", #
            label="to", #
            value="1, 3:5, 7:8"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    plot(1:3)#
    legend("topleft", legend=paste("spm11:", input$spm11))#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifagene\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        tabPanel("tab 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          ),#
          textOutput("txt")#
        ),#
        tabPanel("tab 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
#
    z <- paste0("c(", input$spm, ")")#
    z <- eval(parse(text=z))#
    spm <- paste0("X", z)#
    sel <- dat[#
      dat$Skole %in% c(input$skole) & #
      dat$Trinn %in% c(input$trinn) & #
      dat$Klasse %in% c(input$klasse) & #
      dat$Kj %in% c(input$kjønn) & #
      dat$F.aar %in% c(input$år) & #
      dat$F.mnd %in% c(input$mnd),#
      spm, drop=FALSE]#
    barplot(prop.table(table(unlist(sel))), density=20, col="grey95", space=2/3)#
  })#
  output$txt <- renderPrint({#
    print("…")#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifagene\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        tabPanel("tab 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        tabPanel("tab 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
#
    z <- paste0("c(", input$spm, ")")#
    z <- eval(parse(text=z))#
    spm <- paste0("X", z)#
    sel <- dat[#
      dat$Skole %in% c(input$skole) & #
      dat$Trinn %in% c(input$trinn) & #
      dat$Klasse %in% c(input$klasse) & #
      dat$Kj %in% c(input$kjønn) & #
      dat$F.aar %in% c(input$år) & #
      dat$F.mnd %in% c(input$mnd),#
      spm, drop=FALSE]#
    barplot(prop.table(table(unlist(sel))), density=20, col="grey95", space=2/3)#
  })#
  output$txt <- renderPrint({#
    print("…")#
  })#
}#
shinyApp(ui = ui, server = server)
x <- tt[1:20, 20:30]
x
unlist(x)
x1 <- tt[1:20, 20:30]#
x2 <- tt[1:20, 30:40]#
#
unlist(x1)
x1 <- tt[1:20, 20:30]#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:20, 30:40]#
x2 <- prop.table(table(unlist(x2)))
x2
x1
x2 <- tt[1:2, 30:40]
x2 <- prop.table(table(unlist(x2)))
x2
x2 <- tt[1:2, 30:31]
x2 <- prop.table(table(unlist(x2)))
x2
x1 <- tt[1:20, 20:30]#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:20, 30:35]#
x2 <- prop.table(table(unlist(x2)))
barplot(x1)
cbind(x1, x2)
rbind(x1, x2)
barplot(rbind(x1, x2))
barplot(rbind(x1, x2), beside=TRUE)
barplot(rbind(x1, x2), beside=TRUE, space=3/2)
barplot(rbind(x1, x2), beside=TRUE, space=2:3)
barplot(rbind(x1, x2), beside=TRUE, space=2/3)
barplot(cbind(x1, x2), beside=TRUE, space=2/3)
barplot(rbind(x1, x2), beside=TRUE, space=2/3)
c(x1, x2)
dput(x1)
cbind(x1, x2)
as.table(cbind(x1, x2))
as.table(rbind(x1, x2))
table(rbind(x1, x2))
table(cbind(x1, x2))
as.table(rbind(x1, x2))
tab <- as.table(rbind(x1, x2))
barplot(tab, beside=TRUE, space=2/3)
barplot(tab, beside=TRUE)
barplot(rbind(x1, x2), beside=TRUE)
barplot(cbind(x1, x2), beside=TRUE)
x2
x1 <- tt[1:20, 20:30]#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:20, 30:35]#
x2 <- prop.table(table(unlist(x2)))#
#
barplot(cbind(x1, x2), beside=TRUE)
barplot(rbind(x1, x2), beside=TRUE)
rbind(x1, x2)
tab <-
tab <- rbind(x1, x2)
tab <- rbind(x1, x2)
n1 <- nrow(x1)
x1 <- tt[1:20, 20:30]#
n1 <- nrow(x1)
n1
x1 <- tt[1:20, 20:30]#
n1 <- nrow(x1)#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:25, 30:35]#
n2 <- nrow(x2)#
x2 <- prop.table(table(unlist(x2)))#
#
tab <- rbind(x1, x2)#
colnames(tab) <- c("Unteressert", "Lite interessert", "Litt interessert", "Veldig interessert")#
#
barplot(tab, beside=TRUE)
barplot(tab, beside=TRUE, srt=45)
barplot(tab, beside=TRUE, cex.names=0.8)
legend("top", legend=c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2)))
legend("top", legend=c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2)), bty="n")
x1 <- tt[1:20, 20:30]#
n1 <- nrow(x1)#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:25, 30:35]#
n2 <- nrow(x2)#
x2 <- prop.table(table(unlist(x2)))#
#
tab <- rbind(x1, x2)#
colnames(tab) <- c("Uinteressert", "Lite interessert", "Litt interessert", "Veldig interessert")#
legend("top", legend=c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2)), bty="n")#
#
barplot(tab, beside=TRUE, cex.names=0.8)
x1 <- tt[1:20, 20:30]#
n1 <- nrow(x1)#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:25, 30:35]#
n2 <- nrow(x2)#
x2 <- prop.table(table(unlist(x2)))#
#
tab <- rbind(x1, x2)#
colnames(tab) <- c("Uinteressert", "Lite interessert", "Litt interessert", "Veldig interessert")#
#
barplot(tab, beside=TRUE, cex.names=0.8)#
legend("top", legend=c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2)), bty="n")
x1 <- tt[1:20, 20:30]#
n1 <- nrow(x1)#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:25, 30:35]#
n2 <- nrow(x2)#
x2 <- prop.table(table(unlist(x2)))#
#
tab <- rbind(x1, x2)#
colnames(tab) <- c("Uinteressert", "Lite interessert", "Litt interessert", "Veldig interessert")#
#
barplot(tab, beside=TRUE, cex.names=0.8)#
legend("topleft", legend=c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2)), bty="n")
barplot(tab, beside=TRUE, cex.names=0.8, density=c(20, 40))
barplot(tab, beside=TRUE, cex.names=0.8, density=c(20, 40), col=1)
barplot(tab, beside=TRUE, cex.names=0.8, density=c(20, 40), col=1, lwd=2)
barplot(tab, beside=TRUE, cex.names=0.8, density=c(20, 40), col=1, width=2)
barplot(tab, beside=TRUE, cex.names=0.8, density=c(20, 40), col=1, width=1)
x1 <- tt[1:20, 20:30]#
n1 <- nrow(x1)#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:25, 30:35]#
n2 <- nrow(x2)#
x2 <- prop.table(table(unlist(x2)))#
#
tab <- rbind(x1, x2)#
colnames(tab) <- c("Uinteressert", "Lite interessert", "Litt interessert", "Veldig interessert")#
#
barplot(tab, beside=TRUE, cex.names=0.8, density=c(20, 30), col=1, width=1)#
legend("topleft", legend=c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2)), bty="n")
barplot(tab, beside=TRUE, cex.names=0.8, density=c(20, 30), col=c(1, "grey50"), width=1)
barplot(tab, beside=TRUE, cex.names=0.8, density=c(20, 30), col=c(1, "grey70"), width=1)
barplot(tab, beside=TRUE, cex.names=0.8, density=c(20, 40), col=c(1, "grey70"), width=1)
barplot(tab, beside=TRUE, cex.names=0.8, density=c(20, 40), col=c(1, "grey30"), width=1)
barplot(tab, beside=TRUE, cex.names=0.8, density=c(20, 40), col=c(1, "grey40"), width=1)
barplot(tab, beside=TRUE, cex.names=0.8, density=c(20, 35), col=c(1, "grey40"), width=1)
barplot(tab, beside=TRUE, cex.names=0.8, density=c(20, 35), col=c("grey40", 1), width=1)
barplot(tab, beside=TRUE, cex.names=0.8, density=c(20, 35), col=c("grey40", 0), width=1)
barplot(tab, beside=TRUE, cex.names=0.8, density=c(20, 35), col=c("grey40", 1), width=1)
barplot(tab, beside=TRUE, cex.names=0.8, density=c(20, 30), col=c("grey40", 1), width=1)
barplot(tab, beside=TRUE, cex.names=0.8, density=c(15, 30), col=c("grey40", 1), width=1)
x1 <- tt[1:20, 20:30]#
n1 <- nrow(x1)#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:25, 30:35]#
n2 <- nrow(x2)#
x2 <- prop.table(table(unlist(x2)))#
#
ltext <- legend=c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
#
tab <- rbind(x1, x2)#
colnames(tab) <- c("Uinteressert", "Lite interessert", "Litt interessert", "Veldig interessert")#
#
barplot(tab, beside=TRUE, cex.names=0.8, density=c(15, 30), col=c("grey40", 1), width=1)#
#
legend("topleft", ltext, bty="n")
legend("topleft", legend=ltext, bty="n")
x1 <- tt[1:20, 20:30]#
n1 <- nrow(x1)#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:25, 30:35]#
n2 <- nrow(x2)#
x2 <- prop.table(table(unlist(x2)))#
#
ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
#
tab <- rbind(x1, x2)#
colnames(tab) <- c("Uinteressert", "Lite interessert", "Litt interessert", "Veldig interessert")#
#
barplot(tab, beside=TRUE, cex.names=0.8, density=c(15, 30), col=c("grey40", 1), width=1)#
#
legend("topleft", legend=ltext, bty="n")
legend("topleft", legend=ltext, bty="n", cex=0.8)
x1 <- tt[1:20, 20:30]#
n1 <- nrow(x1)#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:25, 30:35]#
n2 <- nrow(x2)#
x2 <- prop.table(table(unlist(x2)))#
#
ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
#
tab <- rbind(x1, x2)#
colnames(tab) <- c("Uinteressert", "Lite interessert", "Litt interessert", "Veldig interessert")#
#
barplot(tab, beside=TRUE, cex.names=0.8, density=c(15, 30), col=c("grey40", 1), width=1)#
#
legend("topleft", legend=ltext, bty="n", cex=0.8)
legend("topleft", legend=ltext, bty="n", cex=0.8, density=c(15, 30))
x1 <- tt[1:20, 20:30]#
n1 <- nrow(x1)#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:25, 30:35]#
n2 <- nrow(x2)#
x2 <- prop.table(table(unlist(x2)))#
#
ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
#
tab <- rbind(x1, x2)#
colnames(tab) <- c("Uinteressert", "Lite interessert", "Litt interessert", "Veldig interessert")#
#
barplot(tab, beside=TRUE, cex.names=0.8, density=c(15, 30), col=c("grey40", 1), width=1)#
#
legend("topleft", legend=ltext, bty="n", cex=0.8, density=c(15, 30))
x1 <- tt[1:20, 20:30]#
n1 <- nrow(x1)#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:25, 30:35]#
n2 <- nrow(x2)#
x2 <- prop.table(table(unlist(x2)))#
#
ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
#
tab <- rbind(x1, x2)#
colnames(tab) <- c("Uinteressert", "Lite interessert", "Litt interessert", "Veldig interessert")#
#
barplot(tab, beside=TRUE, cex.names=0.8, density=c(15, 30), col=c("grey40", 1), width=1)#
#
legend("topleft", legend=ltext, bty="n", cex=0.9, density=c(15, 30))
x1 <- tt[1:20, 20:30]#
n1 <- nrow(x1)#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:25, 30:35]#
n2 <- nrow(x2)#
x2 <- prop.table(table(unlist(x2)))#
#
ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
#
tab <- rbind(x1, x2)#
colnames(tab) <- c("Uinteressert", "Lite interessert", "Litt interessert", "Veldig interessert")#
#
barplot(tab, beside=TRUE, cex.names=0.8, density=c(15, 30), col=1, width=1)#
#
legend("topleft", legend=ltext, bty="n", cex=0.9, density=c(15, 30))
legend("topleft", legend=ltext, bty="n", cex=0.9, density=c(15, 30), horiz=TRUE)
x1 <- tt[1:20, 20:30]#
n1 <- nrow(x1)#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:25, 30:35]#
n2 <- nrow(x2)#
x2 <- prop.table(table(unlist(x2)))#
#
ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
#
tab <- rbind(x1, x2)#
colnames(tab) <- c("Uinteressert", "Lite interessert", "Litt interessert", "Veldig interessert")#
#
barplot(tab, beside=TRUE, cex.names=0.8, density=c(15, 30), col=1, width=1)#
#
legend("topleft", legend=ltext, bty="n", cex=0.9, density=c(15, 30), horiz=TRUE, xpd=NA, inset=1)
x1 <- tt[1:20, 20:30]#
n1 <- nrow(x1)#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:25, 30:35]#
n2 <- nrow(x2)#
x2 <- prop.table(table(unlist(x2)))#
#
ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
#
tab <- rbind(x1, x2)#
colnames(tab) <- c("Uinteressert", "Lite interessert", "Litt interessert", "Veldig interessert")#
#
barplot(tab, beside=TRUE, cex.names=0.8, density=c(15, 30), col=1, width=1)#
#
legend("topleft", legend=ltext, bty="n", cex=0.9, density=c(15, 30), horiz=TRUE, xpd=NA, inset=0.1)
x1 <- tt[1:20, 20:30]#
n1 <- nrow(x1)#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:25, 30:35]#
n2 <- nrow(x2)#
x2 <- prop.table(table(unlist(x2)))#
#
ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
#
tab <- rbind(x1, x2)#
colnames(tab) <- c("Uinteressert", "Lite interessert", "Litt interessert", "Veldig interessert")#
#
barplot(tab, beside=TRUE, cex.names=0.8, density=c(15, 30), col=1, width=1)#
#
legend("topleft", legend=ltext, bty="n", cex=0.9, density=c(15, 30), horiz=TRUE, xpd=NA, inset=-0.1)
x1 <- tt[1:20, 20:30]#
n1 <- nrow(x1)#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:25, 30:35]#
n2 <- nrow(x2)#
x2 <- prop.table(table(unlist(x2)))#
#
ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
#
tab <- rbind(x1, x2)#
colnames(tab) <- c("Uinteressert", "Lite interessert", "Litt interessert", "Veldig interessert")#
#
barplot(tab, beside=TRUE, cex.names=0.8, density=c(15, 30), col=1, width=1)#
#
legend("top", legend=ltext, bty="n", cex=0.9, density=c(15, 30), horiz=TRUE, xpd=NA, inset=-0.1)
x1 <- tt[1:20, 20:30]#
n1 <- nrow(x1)#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:25, 30:35]#
n2 <- nrow(x2)#
x2 <- prop.table(table(unlist(x2)))#
#
ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
#
tab <- rbind(x1, x2)#
colnames(tab) <- c("Uinteressert", "Lite interessert", "Litt interessert", "Veldig interessert")#
#
barplot(tab, beside=TRUE, cex.names=0.8, density=c(15, 30), col=1, width=1)#
#
legend("top", legend=ltext, bty="n", cex=0.9, density=c(15, 30), horiz=TRUE, xpd=NA, inset=-0.2)
x1 <- tt[1:20, 20:30]#
n1 <- nrow(x1)#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:25, 30:35]#
n2 <- nrow(x2)#
x2 <- prop.table(table(unlist(x2)))#
#
ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
#
tab <- rbind(x1, x2)#
colnames(tab) <- c("Uinteressert", "Lite interessert", "Litt interessert", "Veldig interessert")#
#
barplot(tab, beside=TRUE, cex.names=0.8, density=c(15, 30), col=1, width=1)#
#
legend("top", legend=ltext, bty="n", cex=0.9, density=c(15, 30), horiz=TRUE, xpd=NA, inset=-0.15)
x1 <- tt[1:20, 20:30]#
n1 <- nrow(x1)#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:25, 30:35]#
n2 <- nrow(x2)#
x2 <- prop.table(table(unlist(x2)))#
#
ltext <- c(paste("Utvalg 1: n =", n1, "  "), paste("Utvalg 2: n =", n2))#
#
tab <- rbind(x1, x2)#
colnames(tab) <- c("Uinteressert", "Lite interessert", "Litt interessert", "Veldig interessert")#
#
barplot(tab, beside=TRUE, cex.names=0.8, density=c(15, 30), col=1, width=1)#
#
legend("top", legend=ltext, bty="n", cex=0.9, density=c(15, 30), horiz=TRUE, xpd=NA, inset=-0.15)
x1 <- tt[1:20, 20:30]#
n1 <- nrow(x1)#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:25, 30:35]#
n2 <- nrow(x2)#
x2 <- prop.table(table(unlist(x2)))#
#
ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
#
tab <- rbind(x1, x2)#
colnames(tab) <- c("Uinteressert", "Lite interessert", "Litt interessert", "Veldig interessert")#
#
barplot(tab, beside=TRUE, cex.names=0.8, density=c(15, 30), col=1, width=1)#
#
legend("top", legend=ltext, bty="n", cex=0.9, density=c(15, 30), horiz=TRUE, xpd=NA, inset=-0.15, x.intersp=1)
x1 <- tt[1:20, 20:30]#
n1 <- nrow(x1)#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:25, 30:35]#
n2 <- nrow(x2)#
x2 <- prop.table(table(unlist(x2)))#
#
ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
#
tab <- rbind(x1, x2)#
colnames(tab) <- c("Uinteressert", "Lite interessert", "Litt interessert", "Veldig interessert")#
#
barplot(tab, beside=TRUE, cex.names=0.8, density=c(15, 30), col=1, width=1)#
#
legend("top", legend=ltext, bty="n", cex=0.9, density=c(15, 30), horiz=TRUE, xpd=NA, inset=-0.15, x.intersp=2)
legend("top", legend=ltext, bty="n", cex=0.9, density=c(15, 30), horiz=TRUE, xpd=NA, inset=-0.15, x.intersp=2, xjust=0)
x1 <- tt[1:20, 20:30]#
n1 <- nrow(x1)#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:25, 30:35]#
n2 <- nrow(x2)#
x2 <- prop.table(table(unlist(x2)))#
#
ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
#
tab <- rbind(x1, x2)#
colnames(tab) <- c("Uinteressert", "Lite interessert", "Litt interessert", "Veldig interessert")#
#
barplot(tab, beside=TRUE, cex.names=0.8, density=c(15, 30), col=1, width=1)#
#
legend("top", legend=ltext, bty="n", cex=0.9, density=c(15, 30), horiz=TRUE, xpd=NA, inset=-0.15, x.intersp=2, xjust=0)
x1 <- tt[1:20, 20:30]#
n1 <- nrow(x1)#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:25, 30:35]#
n2 <- nrow(x2)#
x2 <- prop.table(table(unlist(x2)))#
#
ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
#
tab <- rbind(x1, x2)#
colnames(tab) <- c("Uinteressert", "Lite interessert", "Litt interessert", "Veldig interessert")#
#
barplot(tab, beside=TRUE, cex.names=0.8, density=c(15, 30), col=1, width=1)#
#
legend("top", legend=ltext, bty="n", cex=0.9, density=c(15, 30), horiz=TRUE, xpd=NA, inset=-0.15, x.intersp=0.5)
x1 <- tt[1:20, 20:30]#
n1 <- nrow(x1)#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:25, 30:35]#
n2 <- nrow(x2)#
x2 <- prop.table(table(unlist(x2)))#
#
ltext <- c(paste("Utvalg 1: n =", n1, "  "), paste("   Utvalg 2: n =", n2))#
#
tab <- rbind(x1, x2)#
colnames(tab) <- c("Uinteressert", "Lite interessert", "Litt interessert", "Veldig interessert")#
#
barplot(tab, beside=TRUE, cex.names=0.8, density=c(15, 30), col=1, width=1)#
#
legend("top", legend=ltext, bty="n", cex=0.9, density=c(15, 30), horiz=TRUE, xpd=NA, inset=-0.15, x.intersp=0.5)
x1 <- tt[1:20, 20:30]#
n1 <- nrow(x1)#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:25, 30:35]#
n2 <- nrow(x2)#
x2 <- prop.table(table(unlist(x2)))#
#
ltext <- c(paste("Utvalg 1: n =", n1, "  "), paste("Utvalg 2: n =", n2))#
#
tab <- rbind(x1, x2)#
colnames(tab) <- c("Uinteressert", "Lite interessert", "Litt interessert", "Veldig interessert")#
#
barplot(tab, beside=TRUE, cex.names=0.8, density=c(15, 30), col=1, width=1)#
#
legend("top", legend=ltext, bty="n", cex=0.9, density=c(15, 30), horiz=TRUE, xpd=NA, inset=-0.15, x.intersp=0.5)
x1 <- tt[1:20, 20:30]#
n1 <- nrow(x1)#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:25, 30:35]#
n2 <- nrow(x2)#
x2 <- prop.table(table(unlist(x2)))#
#
ltext <- c(paste("Utvalg 1: n =", n1, "     "), paste("Utvalg 2: n =", n2))#
#
tab <- rbind(x1, x2)#
colnames(tab) <- c("Uinteressert", "Lite interessert", "Litt interessert", "Veldig interessert")#
#
barplot(tab, beside=TRUE, cex.names=0.8, density=c(15, 30), col=1, width=1)#
#
legend("top", legend=ltext, bty="n", cex=0.9, density=c(15, 30), horiz=TRUE, xpd=NA, inset=-0.15, x.intersp=0.5)
legend("top", legend=ltext, bty="n", cex=0.9, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15, x.intersp=0.5)
x1 <- tt[1:20, 20:30]#
n1 <- nrow(x1)#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:25, 30:35]#
n2 <- nrow(x2)#
x2 <- prop.table(table(unlist(x2)))#
#
ltext <- c(paste("Utvalg 1: n =", n1, "     "), paste("Utvalg 2: n =", n2))#
#
tab <- rbind(x1, x2)#
colnames(tab) <- c("Uinteressert", "Lite interessert", "Litt interessert", "Veldig interessert")#
#
barplot(tab, beside=TRUE, cex.names=0.8, density=c(15, 30), col=1, width=1)#
#
legend("top", legend=ltext, bty="n", cex=0.9, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15, x.intersp=0.5)
x1 <- tt[1:20, 20:30]#
n1 <- nrow(x1)#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:25, 30:35]#
n2 <- nrow(x2)#
x2 <- prop.table(table(unlist(x2)))#
#
ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
#
tab <- rbind(x1, x2)#
colnames(tab) <- c("Uinteressert", "Lite interessert", "Litt interessert", "Veldig interessert")#
#
barplot(tab, beside=TRUE, cex.names=0.8, density=c(15, 30), col=1, width=1)#
#
legend("top", legend=ltext, bty="n", cex=0.9, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15, x.intersp=0.5)
legend("top", legend=ltext, bty="n", cex=0.9, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15, x.intersp=0.5, xjust=0.5)
legend("top", legend=ltext, bty="n", cex=0.9, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15, x.intersp=1, xjust=0.5)
x1 <- tt[1:20, 20:30]#
n1 <- nrow(x1)#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:25, 30:35]#
n2 <- nrow(x2)#
x2 <- prop.table(table(unlist(x2)))#
#
ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
#
tab <- rbind(x1, x2)#
colnames(tab) <- c("Uinteressert", "Lite interessert", "Litt interessert", "Veldig interessert")#
#
barplot(tab, beside=TRUE, cex.names=0.8, density=c(15, 30), col=1, width=1)#
#
legend("top", legend=ltext, bty="n", cex=0.9, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15, x.intersp=1, xjust=0.5)
legend("top", legend=ltext, bty="n", cex=0.9, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15, x.intersp=1, xjust=0.5, adj=0.5)
legend("top", legend=ltext, bty="n", cex=0.9, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15, x.intersp=1, xjust=0.5, adj=-0.5)
x1 <- tt[1:20, 20:30]#
n1 <- nrow(x1)#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:25, 30:35]#
n2 <- nrow(x2)#
x2 <- prop.table(table(unlist(x2)))#
#
ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
#
tab <- rbind(x1, x2)#
colnames(tab) <- c("Uinteressert", "Lite interessert", "Litt interessert", "Veldig interessert")#
#
barplot(tab, beside=TRUE, cex.names=0.8, density=c(15, 30), col=1, width=1)#
#
legend("top", legend=ltext, bty="n", cex=0.9, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15, x.intersp=1, xjust=0.5, adj=-0.1)
x1 <- tt[1:20, 20:30]#
n1 <- nrow(x1)#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:25, 30:35]#
n2 <- nrow(x2)#
x2 <- prop.table(table(unlist(x2)))#
#
ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
#
tab <- rbind(x1, x2)#
colnames(tab) <- c("Uinteressert", "Lite interessert", "Litt interessert", "Veldig interessert")#
#
barplot(tab, beside=TRUE, cex.names=0.8, density=c(15, 30), col=1, width=1)#
#
legend("top", legend=ltext, bty="n", cex=0.9, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15, x.intersp=1, xjust=0.5)
x1 <- tt[1:20, 20:30]#
n1 <- nrow(x1)#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:25, 30:35]#
n2 <- nrow(x2)#
x2 <- prop.table(table(unlist(x2)))#
#
ltext <- c(paste("Utvalg 1: n =", n1), " ", paste("Utvalg 2: n =", n2))#
#
tab <- rbind(x1, x2)#
colnames(tab) <- c("Uinteressert", "Lite interessert", "Litt interessert", "Veldig interessert")#
#
barplot(tab, beside=TRUE, cex.names=0.8, density=c(15, 30), col=1, width=1)#
#
legend("top", legend=ltext, bty="n", cex=0.9, density=c(15, 30), ncol=3, xpd=NA, inset=-0.15)
x1 <- tt[1:20, 20:30]#
n1 <- nrow(x1)#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:25, 30:35]#
n2 <- nrow(x2)#
x2 <- prop.table(table(unlist(x2)))#
#
ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
#
tab <- rbind(x1, x2)#
colnames(tab) <- c("Uinteressert", "Lite interessert", "Litt interessert", "Veldig interessert")#
#
barplot(tab, beside=TRUE, cex.names=0.8, density=c(15, 30), col=1, width=1)#
#
legend("top", legend=ltext, bty="n", cex=0.9, density=c(15, 30), ncol=3, xpd=NA, inset=-0.15)
x1 <- tt[1:20, 20:30]#
n1 <- nrow(x1)#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:25, 30:35]#
n2 <- nrow(x2)#
x2 <- prop.table(table(unlist(x2)))#
#
ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
#
tab <- rbind(x1, x2)#
colnames(tab) <- c("Uinteressert", "Lite interessert", "Litt interessert", "Veldig interessert")#
#
barplot(tab, beside=TRUE, cex.names=0.8, density=c(15, 30), col=1, width=1)#
#
legend("top", legend=ltext, bty="n", cex=0.9, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15)
dat <- readRDS("supp/bioint.rds")
colnames(dat)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifagene\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        tabPanel("tab 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        tabPanel("tab 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="1, 3:5, 7, 9, 57:61"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=0.8, density=c(15, 30), col=1)#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=0.9, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifagene\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        tabPanel("tab 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        tabPanel("tab 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1, density=c(15, 30), col=1)#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
tabPanel
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifagene\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        tabPanel("tab 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        tabPanel("tab 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1, density=c(15, 30), col=1)#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifagene\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        tabPanel("tab 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        tabPanel("tab 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1, density=c(15, 30), col=1)#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
tabPanel
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifagene\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        tabPanel("tab 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        tabPanel("tab 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1, density=c(15, 30), col=1)#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifagene\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1, density=c(15, 30), col=1)#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifagene\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1, density=c(15, 30), col=1)#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifagene\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1, density=c(15, 30), col=1)#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifagene\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1, density=c(15, 30), col=1)#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifagene\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1, density=c(15, 30), col=1)#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
    tags$style(HTML("#
    .tabbable > .nav > li > a                  {background-color: aqua;  color:black}#
    .tabbable > .nav > li > a[data-value='t1'] {background-color: red;   color:white}#
    .tabbable > .nav > li > a[data-value='t2'] {background-color: blue;  color:white}#
    .tabbable > .nav > li > a[data-value='t3'] {background-color: green; color:white}#
    .tabbable > .nav > li[class=active]    > a {background-color: black; color:white}#
  ")),#
  titlePanel("Responser fra NOU: \"Interesse for biologifagene\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1, density=c(15, 30), col=1)#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
    tags$style(HTML("#
    .tabbable > .nav > li > a                  {background-color: black;  color:grey}#
    .tabbable > .nav > li[class=active]    > a {background-color: grey; color:white}#
  ")),#
  titlePanel("Responser fra NOU: \"Interesse for biologifagene\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1, density=c(15, 30), col=1)#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
    tags$style(HTML("#
    .tabbable > .nav > li > a                  {background-color: white;  color: grey}#
    .tabbable > .nav > li[class=active]    > a {background-color: white; color: black}#
  ")),#
  titlePanel("Responser fra NOU: \"Interesse for biologifagene\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1, density=c(15, 30), col=1)#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
    tags$style(HTML("#
    .tabbable > .nav > li > a                  {background-color: white;  color: grey}#
    .tabbable > .nav > li[class=active]    > a {background-color: white; color: black}#
  ")),#
  titlePanel("Responser fra NOU: \"Interesse for biologifagene\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1, density=c(15, 30), col=1)#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
    tags$style(HTML("#
    .tabbable > .nav > li > a                  {background-color: white;  color: grey}#
    .tabbable > .nav > li[class=active]    > a {background-color: white; color: black}#
  ")),#
  titlePanel("Responser fra NOU: \"Interesse for biologifagene\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1, density=c(15, 30), col=1)#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
    tags$style(HTML("#
    .tabbable > .nav > li > a                  {background-color: white;  color: grey}#
    .tabbable > .nav > li[class=active]    > a {background-color: white; color: black}#
  ")),#
  titlePanel("Responser fra NOU: \"Interesse for biologifagene\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1, density=c(15, 30), col=1)#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
    tags$style(HTML("#
    .tabbable > .nav > li > a                  {background-color: white;  color: grey}#
    .tabbable > .nav > li[class=active]    > a {background-color: white; color: black}#
  ")),#
  titlePanel("Responser fra NOU: \"Interesse for biologifagene\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1, density=c(15, 30), col=1)#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
    tags$style(HTML("#
    .tabbable > .nav > li > a                  {background-color: white;  color: #888888}#
    .tabbable > .nav > li[class=active]    > a {background-color: white; color: black}#
  ")),#
  titlePanel("Responser fra NOU: \"Interesse for biologifagene\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1, density=c(15, 30), col=1)#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
    tags$style(HTML("#
    .tabbable > .nav > li > a                  {background-color: white;  color: #888888}#
    .tabbable > .nav > li[class=active]    > a {background-color: white; color: black}#
  ")),#
  titlePanel("Responser fra NOU: \"Interesse for biologifagene\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1, density=c(15, 30), col=1)#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
    tags$style(HTML("#
    .tabbable > .nav > li > a                  {background-color: white;  color: #888888}#
    .tabbable > .nav > li[class=active]    > a {background-color: white; color: black}#
  ")),#
  titlePanel("Responser fra NOU: \"Interesse for biologifagene\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1, density=c(15, 30), col=1)#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
    tags$style(HTML("#
    .tabbable > .nav > li > a                  {background-color: #f8f8f8;  color: #888888}#
    .tabbable > .nav > li[class=active]    > a {background-color: #f8f8f8; color: black}#
  ")),#
  titlePanel("Responser fra NOU: \"Interesse for biologifagene\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1, density=c(15, 30), col=1)#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
    tags$style(HTML("#
    .tabbable > .nav > li > a                  {background-color: #e8e8e8;  color: #888888}#
    .tabbable > .nav > li[class=active]    > a {background-color: #e8e8e8; color: black}#
  ")),#
  titlePanel("Responser fra NOU: \"Interesse for biologifagene\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1, density=c(15, 30), col=1)#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
    tags$style(HTML("#
    .tabbable > .nav > li > a                  {background-color: #e0e0e0;  color: #888888}#
    .tabbable > .nav > li[class=active]    > a {background-color: #e8e8e8; color: black}#
  ")),#
  titlePanel("Responser fra NOU: \"Interesse for biologifagene\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1, density=c(15, 30), col=1)#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
    tags$style(HTML("#
    .tabbable > .nav > li > a                  {background-color: #e0e0e0;  color: #999999}#
    .tabbable > .nav > li[class=active]    > a {background-color: #e8e8e8; color: black}#
  ")),#
  titlePanel("Responser fra NOU: \"Interesse for biologifagene\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1, density=c(15, 30), col=1)#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
    tags$style(HTML("#
    .tabbable > .nav > li > a                  {background-color: #e0e0e0;  color: #999999}#
    .tabbable > .nav > li[class=active]    > a {background-color: #e8e8e8; color: black}#
  ")),#
  titlePanel("Responser fra NOU: \"Interesse for biologifagene\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1, density=c(15, 30), col=1)#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
    tags$style(HTML("#
    .tabbable > .nav > li > a                  {background-color: #e0e0e0;  color: #999999}#
    .tabbable > .nav > li[class=active]    > a {background-color: #e8e8e8; color: black}#
  ")),#
  titlePanel("Responser fra NOU: \"Interesse for biologifagene\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1, density=c(15, 30), col=1)#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
    tags$style(HTML("#
    .tabbable > .nav > li > a                  {background-color: #e0e0e0;  color: #999999}#
    .tabbable > .nav > li[class=active]    > a {background-color: #f0f0f0; color: black}#
  ")),#
  titlePanel("Responser fra NOU: \"Interesse for biologifagene\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1, density=c(15, 30), col=1)#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
    tags$style(HTML("#
    .tabbable > .nav > li > a                  {background-color: #f8f8f8;  color: #999999}#
    .tabbable > .nav > li[class=active]    > a {background-color: #f0f0f0; color: black}#
  ")),#
  titlePanel("Responser fra NOU: \"Interesse for biologifagene\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1, density=c(15, 30), col=1)#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
    tags$style(HTML("#
    .tabbable > .nav > li > a                  {background-color: #e8e8e8;  color: #999999}#
    .tabbable > .nav > li[class=active]    > a {background-color: #f0f0f0; color: black}#
  ")),#
  titlePanel("Responser fra NOU: \"Interesse for biologifagene\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1, density=c(15, 30), col=1)#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
    tags$style(HTML("#
    .tabbable > .nav > li > a                  {background-color: #f0f0f0;  color: #999999}#
    .tabbable > .nav > li[class=active]    > a {background-color: #f0f0f0; color: black}#
  ")),#
  titlePanel("Responser fra NOU: \"Interesse for biologifagene\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1, density=c(15, 30), col=1)#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
    tags$style(HTML("#
    .tabbable > .nav > li > a                  {background-color: #e0e0e0;  color: #999999}#
    .tabbable > .nav > li[class=active]    > a {background-color: #f0f0f0; color: black}#
  ")),#
  titlePanel("Responser fra NOU: \"Interesse for biologifagene\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1, density=c(15, 30), col=1)#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
    tags$style(HTML("#
    .tabbable > .nav > li > a                  {background-color: #e8e8e8;  color: #999999}#
    .tabbable > .nav > li[class=active]    > a {background-color: #f0f0f0; color: black}#
  ")),#
  titlePanel("Responser fra NOU: \"Interesse for biologifagene\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1, density=c(15, 30), col=1)#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
    tags$style(HTML("#
    .tabbable > .nav > li > a                  {background-color: #e8e8e8;  color: #999999}#
    .tabbable > .nav > li[class=active]    > a {background-color: #f0f0f0; color: black}#
  ")),#
  titlePanel("Responser fra NOU: \"Interesse for biologifaget\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1, density=c(15, 30), col=1)#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
    tags$style(HTML("#
    .tabbable > .nav > li > a                  {background-color: #e8e8e8;  color: #999999}#
    .tabbable > .nav > li[class=active]    > a {background-color: #f0f0f0; color: black}#
  ")),#
  titlePanel("Responser fra NOU: \"Interesse for biologifaget\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    par(cex=2)#
    barplot(tab, beside=TRUE, cex.names=1, density=c(15, 30), col=1)#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
    tags$style(HTML("#
    .tabbable > .nav > li > a                  {background-color: #e8e8e8;  color: #999999}#
    .tabbable > .nav > li[class=active]    > a {background-color: #f0f0f0; color: black}#
  ")),#
  titlePanel("Responser fra NOU: \"Interesse for biologifaget\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1.5, density=c(15, 30), col=1)#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1.1, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
    tags$style(HTML("#
    .tabbable > .nav > li > a                  {background-color: #e8e8e8;  color: #999999}#
    .tabbable > .nav > li[class=active]    > a {background-color: #f0f0f0; color: black}#
  ")),#
  titlePanel("Responser fra NOU: \"Interesse for biologifaget\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1.5, density=c(15, 30), col=1)#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1.5, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
    tags$style(HTML("#
    .tabbable > .nav > li > a                  {background-color: #e8e8e8;  color: #999999}#
    .tabbable > .nav > li[class=active]    > a {background-color: #f0f0f0; color: black}#
  ")),#
  titlePanel("Responser fra NOU: \"Interesse for biologifaget\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1.5, density=c(10, 20), col=1)#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1.5, density=c(10, 20), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifaget\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1.5, density=c(10, 20), col=1)#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1.5, density=c(10, 20), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifaget\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1.5, density=c(10, 20), col=1)#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1.5, density=c(10, 20), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifaget\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1.5, density=c(10, 20), col=1)#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1.5, density=c(10, 20), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
deployApp("~/Documents/R/shiny/bioint")
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifaget\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1.5, density=c(10, 20), col=1,#
      ylab="Relativ frekvens")#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1.5, density=c(10, 20), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifaget\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1.5, density=c(10, 20), col=1,#
      ylab="Relativ frekvens")#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1.5, density=c(10, 20), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifaget\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1.5, density=c(10, 20), col=1,#
      ylab="Relativ frekvens")#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1.5, density=c(10, 20), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifaget\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1.5, density=c(10, 20), col=1,#
      ylab="Relativ frekvens")#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1.5, density=c(10, 20), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifaget\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1.5, density=c(10, 20), col=1,#
      ylab="Relativ frekvens")#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1.5, density=c(10, 20), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifaget\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1.5, density=c(10, 20), col=1,#
      ylab="Relativ frekvens")#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1.5, density=c(10, 20), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifaget\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          tags$div(class="topmar", h5("Skole")),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1.5, density=c(10, 20), col=1,#
      ylab="Relativ frekvens")#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1.5, density=c(10, 20), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifaget\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          tags$div(class="topmar", h5("Skole")),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1.5, density=c(10, 20), col=1,#
      ylab="Relativ frekvens")#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1.5, density=c(10, 20), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifaget\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          tags$div(class="topmar", h5("Skole")),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1.5, density=c(10, 20), col=1,#
      ylab="Relativ frekvens")#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1.5, density=c(10, 20), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifaget\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          tags$div(class="topmar", h5("Skole")),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1.5, density=c(10, 20), col=1,#
      ylab="Relativ frekvens")#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1.5, density=c(10, 20), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifaget\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          tags$div(class="topmar", h5("Skole")),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1.5, cex.axis=1.5, density=c(10, 20), #
      col=1, ylab="Relativ frekvens")#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1.5, density=c(10, 20), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
x1 <- tt[1:20, 20:30]#
n1 <- nrow(x1)#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:25, 30:35]#
n2 <- nrow(x2)#
x2 <- prop.table(table(unlist(x2)))#
#
ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
#
tab <- rbind(x1, x2)#
colnames(tab) <- c("Uinteressert", "Lite interessert", #
  "Litt interessert", "Veldig interessert")#
#
barplot(tab, beside=TRUE, cex.names=0.8, density=c(15, 30), col=1, ylab="Relativ frekvens")#
#
legend("top", legend=ltext, bty="n", cex=0.9, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15)
barplot(tab, beside=TRUE, cex.names=0.8, cex=2, density=c(15, 30), col=1, ylab="Relativ frekvens")
barplot(tab, beside=TRUE, cex.names=0.8, cex.lab=2, density=c(15, 30), col=1, ylab="Relativ frekvens")
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifaget\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          tags$div(class="topmar", h5("Skole")),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    barplot(tab, beside=TRUE, cex.names=1.5, cex.lab=1.5, density=c(10, 20), #
      col=1, ylab="Relativ frekvens")#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1.5, density=c(10, 20), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
x1 <- tt[1:20, 20:30]#
n1 <- nrow(x1)#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:25, 30:35]#
n2 <- nrow(x2)#
x2 <- prop.table(table(unlist(x2)))#
#
ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
#
tab <- rbind(x1, x2)#
colnames(tab) <- c("Uinteressert", "Lite interessert", #
  "Litt interessert", "Veldig interessert")#
#
par(mgp=c(1, 2, 0))#
#
barplot(tab, beside=TRUE, cex.names=0.8, cex.lab=2, density=c(15, 30), col=1, ylab="Relativ frekvens")#
#
legend("top", legend=ltext, bty="n", cex=0.9, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15)
x1 <- tt[1:20, 20:30]#
n1 <- nrow(x1)#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:25, 30:35]#
n2 <- nrow(x2)#
x2 <- prop.table(table(unlist(x2)))#
#
ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
#
tab <- rbind(x1, x2)#
colnames(tab) <- c("Uinteressert", "Lite interessert", #
  "Litt interessert", "Veldig interessert")#
#
par(mgp=c(1, 0, 0))#
#
barplot(tab, beside=TRUE, cex.names=0.8, cex.lab=2, density=c(15, 30), col=1, ylab="Relativ frekvens")#
#
legend("top", legend=ltext, bty="n", cex=0.9, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15)
x1 <- tt[1:20, 20:30]#
n1 <- nrow(x1)#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:25, 30:35]#
n2 <- nrow(x2)#
x2 <- prop.table(table(unlist(x2)))#
#
ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
#
tab <- rbind(x1, x2)#
colnames(tab) <- c("Uinteressert", "Lite interessert", #
  "Litt interessert", "Veldig interessert")#
#
par(mgp=c(1, 0.5, 0))#
#
barplot(tab, beside=TRUE, cex.names=0.8, cex.lab=2, density=c(15, 30), col=1, ylab="Relativ frekvens")#
#
legend("top", legend=ltext, bty="n", cex=0.9, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15)
x1 <- tt[1:20, 20:30]#
n1 <- nrow(x1)#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:25, 30:35]#
n2 <- nrow(x2)#
x2 <- prop.table(table(unlist(x2)))#
#
ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
#
tab <- rbind(x1, x2)#
colnames(tab) <- c("Uinteressert", "Lite interessert", #
  "Litt interessert", "Veldig interessert")#
#
par(mgp=c(1, 0.6, 0))#
#
barplot(tab, beside=TRUE, cex.names=0.8, cex.lab=2, density=c(15, 30), col=1, ylab="Relativ frekvens")#
#
legend("top", legend=ltext, bty="n", cex=0.9, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15)
x1 <- tt[1:20, 20:30]#
n1 <- nrow(x1)#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:25, 30:35]#
n2 <- nrow(x2)#
x2 <- prop.table(table(unlist(x2)))#
#
ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
#
tab <- rbind(x1, x2)#
colnames(tab) <- c("Uinteressert", "Lite interessert", #
  "Litt interessert", "Veldig interessert")#
#
par(mgp=c(1.5, 0.6, 0))#
#
barplot(tab, beside=TRUE, cex.names=0.8, cex.lab=2, density=c(15, 30), col=1, ylab="Relativ frekvens")#
#
legend("top", legend=ltext, bty="n", cex=0.9, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15)
x1 <- tt[1:20, 20:30]#
n1 <- nrow(x1)#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:25, 30:35]#
n2 <- nrow(x2)#
x2 <- prop.table(table(unlist(x2)))#
#
ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
#
tab <- rbind(x1, x2)#
colnames(tab) <- c("Uinteressert", "Lite interessert", #
  "Litt interessert", "Veldig interessert")#
#
par(mgp=c(1.8, 0.6, 0))#
#
barplot(tab, beside=TRUE, cex.names=0.8, cex.lab=2, density=c(15, 30), col=1, ylab="Relativ frekvens")#
#
legend("top", legend=ltext, bty="n", cex=0.9, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifaget\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          tags$div(class="topmar", h5("Skole")),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    par(mgp=c(1.8, 0.6, 0))#
#
    barplot(tab, beside=TRUE, cex.names=1.5, cex.lab=1.5, density=c(10, 20), #
      col=1, ylab="Relativ frekvens")#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1.5, density=c(10, 20), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifaget\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          tags$div(class="topmar", h5("Skole")),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    par(mgp=c(2, 0.6, 0), mar=c(2, 3, 3, 1))#
#
    barplot(tab, beside=TRUE, cex.names=1.5, cex.lab=1.5, density=c(10, 20), #
      col=1, ylab="Relativ frekvens")#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1.5, density=c(10, 20), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifaget\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          tags$div(class="topmar", h5("Skole")),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    par(mgp=c(2, 0.6, 0), mar=c(2, 3.5, 4, 1))#
#
    barplot(tab, beside=TRUE, cex.names=1.5, cex.lab=1.5, density=c(10, 20), #
      col=1, ylab="Relativ frekvens")#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1.5, density=c(10, 20), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifaget\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          tags$div(class="topmar", h5("Skole")),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    par(mgp=c(2.5, 0.8, 0), mar=c(2, 3.5, 4, 1))#
#
    barplot(tab, beside=TRUE, cex.names=1.5, cex.lab=1.5, density=c(10, 20), #
      col=1, ylab="Relativ frekvens")#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1.5, density=c(10, 20), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifaget\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          tags$div(class="topmar", h5("Skole")),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    par(mgp=c(2.2, 0.8, 0), mar=c(2, 3.5, 4, 1))#
#
    barplot(tab, beside=TRUE, cex.names=1.5, cex.lab=1.5, density=c(10, 20), #
      col=1, ylab="Relativ frekvens")#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1.5, density=c(10, 20), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifaget\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          tags$div(class="topmar", h5("Skole")),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    par(mgp=c(2.5, 0.8, 0), mar=c(2, 3.8, 4, 1))#
#
    barplot(tab, beside=TRUE, cex.names=1.5, cex.lab=1.5, density=c(10, 20), #
      col=1, ylab="Relativ frekvens")#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1.5, density=c(10, 20), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifaget\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          tags$div(class="topmar", h5("Skole")),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    par(mgp=c(2.5, 0.8, 0), mar=c(2, 3.8, 4, 1))#
#
    barplot(tab, beside=TRUE, cex.names=1.5, cex.lab=1.5, density=c(8, 15), #
      col=1, ylab="Relativ frekvens")#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, #
      bty="n", cex=1.5, density=c(8, 15), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifaget\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          tags$div(class="topmar", h5("Skole")),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    par(mgp=c(2.5, 0.8, 0), mar=c(2, 3.8, 4, 1))#
#
    barplot(tab, beside=TRUE, cex.names=1.5, cex.lab=1.5, density=c(8, 15), #
      col=c(1, "grey60"), ylab="Relativ frekvens")#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, col=c(1, "grey60"),#
      bty="n", cex=1.5, density=c(8, 15), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifaget\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          tags$div(class="topmar", h5("Skole")),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    par(mgp=c(2.5, 0.8, 0), mar=c(2, 3.8, 4, 1))#
#
    barplot(tab, beside=TRUE, cex.names=1.5, cex.lab=1.5, density=c(10, 20), #
      col=c(1, "grey50"), ylab="Relativ frekvens")#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, col=c(1, "grey50"),#
      bty="n", cex=1.5, density=c(10, 20), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
x1 <- tt[1:20, 20:30]#
n1 <- nrow(x1)#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:25, 30:35]#
n2 <- nrow(x2)#
x2 <- prop.table(table(unlist(x2)))#
#
ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
#
tab <- rbind(x1, x2)#
colnames(tab) <- c("Uinteressert", "Lite interessert", #
  "Litt interessert", "Veldig interessert")#
#
par(mgp=c(1.8, 0.6, 0))#
#
barplot(tab, beside=TRUE, cex.names=0.8, cex.lab=2, density=c(15, 30), col=c(1, "grey90"), ylab="Relativ frekvens")#
#
legend("top", legend=ltext, bty="n", cex=0.9, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifaget\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          tags$div(class="topmar", h5("Skole")),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    par(mgp=c(2.5, 0.8, 0), mar=c(2, 3.8, 4, 1))#
#
    barplot(tab, beside=TRUE, cex.names=1.5, cex.lab=1.5, density=c(10, 20), #
      col=c(1, "grey80"), ylab="Relativ frekvens")#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, col=c(1, "grey80"),#
      bty="n", cex=1.5, density=c(10, 20), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
x1 <- tt[1:20, 20:30]#
n1 <- nrow(x1)#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:25, 30:35]#
n2 <- nrow(x2)#
x2 <- prop.table(table(unlist(x2)))#
#
ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
#
tab <- rbind(x1, x2)#
colnames(tab) <- c("Uinteressert", "Lite interessert", #
  "Litt interessert", "Veldig interessert")#
#
par(mgp=c(1.8, 0.6, 0))#
#
barplot(tab, beside=TRUE, cex.names=0.8, cex.lab=2, density=c(15, 30), col=c(1, "grey90"), ylab="Relativ frekvens")#
#
legend("top", legend=ltext, bty="n", cex=0.9, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15, col=c(1, "grey90"))
x1 <- tt[1:20, 20:30]#
n1 <- nrow(x1)#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:25, 30:35]#
n2 <- nrow(x2)#
x2 <- prop.table(table(unlist(x2)))#
#
ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
#
tab <- rbind(x1, x2)#
colnames(tab) <- c("Uinteressert", "Lite interessert", #
  "Litt interessert", "Veldig interessert")#
#
par(mgp=c(1.8, 0.6, 0))#
#
barplot(tab, beside=TRUE, cex.names=0.8, cex.lab=2, density=c(15, 30), col=c(1, "grey90"), ylab="Relativ frekvens")#
#
legend("top", legend=ltext, bty="n", cex=0.9, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15, box.col=c(1, "grey90"))
x1 <- tt[1:20, 20:30]#
n1 <- nrow(x1)#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:25, 30:35]#
n2 <- nrow(x2)#
x2 <- prop.table(table(unlist(x2)))#
#
ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
#
tab <- rbind(x1, x2)#
colnames(tab) <- c("Uinteressert", "Lite interessert", #
  "Litt interessert", "Veldig interessert")#
#
par(mgp=c(1.8, 0.6, 0))#
#
barplot(tab, beside=TRUE, cex.names=0.8, cex.lab=2, density=c(15, 30), col=c(1, "grey90"), ylab="Relativ frekvens")#
#
legend("top", legend=ltext, bty="n", cex=0.9, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15, bg=c(1, "grey90"))
x1 <- tt[1:20, 20:30]#
n1 <- nrow(x1)#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:25, 30:35]#
n2 <- nrow(x2)#
x2 <- prop.table(table(unlist(x2)))#
#
ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
#
tab <- rbind(x1, x2)#
colnames(tab) <- c("Uinteressert", "Lite interessert", #
  "Litt interessert", "Veldig interessert")#
#
par(mgp=c(1.8, 0.6, 0))#
#
barplot(tab, beside=TRUE, cex.names=0.8, cex.lab=2, density=c(15, 30), col=c(1, "grey90"), ylab="Relativ frekvens")#
#
legend("top", legend=ltext, bty="n", cex=0.9, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15, pt.bg=c(1, "grey90"))
x1 <- tt[1:20, 20:30]#
n1 <- nrow(x1)#
x1 <- prop.table(table(unlist(x1)))#
#
x2 <- tt[1:25, 30:35]#
n2 <- nrow(x2)#
x2 <- prop.table(table(unlist(x2)))#
#
ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
#
tab <- rbind(x1, x2)#
colnames(tab) <- c("Uinteressert", "Lite interessert", #
  "Litt interessert", "Veldig interessert")#
#
par(mgp=c(1.8, 0.6, 0))#
#
barplot(tab, beside=TRUE, cex.names=0.8, cex.lab=2, density=c(15, 30), col=c(1, "grey90"), ylab="Relativ frekvens")#
#
legend("top", legend=ltext, bty="n", cex=0.9, density=c(15, 30), ncol=2, xpd=NA, inset=-0.15, fill=c(1, "grey90"))
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifaget\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          tags$div(class="topmar", h5("Skole")),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    par(mgp=c(2.5, 0.8, 0), mar=c(2, 3.8, 4, 1))#
#
    barplot(tab, beside=TRUE, cex.names=1.5, cex.lab=1.5, density=c(10, 20), #
      col=c(1, "grey80"), ylab="Relativ frekvens")#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, fill=c(1, "grey80"),#
      bty="n", cex=1.5, density=c(10, 20), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifaget\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          tags$div(class="topmar", h5("Skole")),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    par(mgp=c(2.5, 0.8, 0), mar=c(2, 3.8, 4, 1))#
#
    barplot(tab, beside=TRUE, cex.names=1.5, cex.lab=1.5, density=c(10, 15), #
      col=c(1, "#27c93a"), ylab="Relativ frekvens")#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, fill=c(1, "#27c93a"),#
      bty="n", cex=1.5, density=c(10, 15), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifaget\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          tags$div(class="topmar", h5("Skole")),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    par(mgp=c(2.5, 0.8, 0), mar=c(2, 3.8, 4, 1))#
#
    barplot(tab, beside=TRUE, cex.names=1.5, cex.lab=1.5, density=c(12, 8), #
      col=c(1, "#27c93a"), ylab="Relativ frekvens")#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, fill=c(1, "#27c93a"),#
      bty="n", cex=1.5, density=c(12, 8), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifaget\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          tags$div(class="topmar", h5("Skole")),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    par(mgp=c(2.5, 0.8, 0), mar=c(2, 3.8, 4, 1))#
#
    barplot(tab, beside=TRUE, cex.names=1.5, cex.lab=1.5, density=c(12, 6), #
      col=c(1, "#27c93a"), ylab="Relativ frekvens")#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, fill=c(1, "#27c93a"),#
      bty="n", cex=1.5, density=c(12, 6), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra NOU: \"Interesse for biologifaget\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          tags$div(class="topmar", h5("Skole")),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    par(mgp=c(2.5, 0.8, 0), mar=c(2, 3.8, 4, 1))#
#
    barplot(tab, beside=TRUE, cex.names=1.5, cex.lab=1.5, density=c(12, 9), #
      col=c(1, "#27c93a"), ylab="Relativ frekvens")#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, fill=c(1, "#27c93a"),#
      bty="n", cex=1.5, density=c(12, 9), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra utgreiing: \"Interesse for biologifaget\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          tags$div(class="topmar", h5("Skole")),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    par(mgp=c(2.5, 0.8, 0), mar=c(2, 3.8, 4, 1))#
#
    barplot(tab, beside=TRUE, cex.names=1.5, cex.lab=1.5, density=c(12, 9), #
      col=c(1, "#27c93a"), ylab="Relativ frekvens")#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, fill=c(1, "#27c93a"),#
      bty="n", cex=1.5, density=c(12, 9), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra utgreiinga", em("Interesse for biologifaget")),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          tags$div(class="topmar", h5("Skole")),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    par(mgp=c(2.5, 0.8, 0), mar=c(2, 3.8, 4, 1))#
#
    barplot(tab, beside=TRUE, cex.names=1.5, cex.lab=1.5, density=c(12, 9), #
      col=c(1, "#27c93a"), ylab="Relativ frekvens")#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, fill=c(1, "#27c93a"),#
      bty="n", cex=1.5, density=c(12, 9), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra utgreiinga", em("Interesse for biologifaget")),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          tags$div(class="topmar", h5("Skole")),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    par(mgp=c(2.5, 0.8, 0), mar=c(2, 3.8, 4, 1))#
#
    barplot(tab, beside=TRUE, cex.names=1.5, cex.lab=1.5, density=c(12, 9), #
      col=c(1, "#27c93a"), ylab="Relativ frekvens")#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, fill=c(1, "#27c93a"),#
      bty="n", cex=1.5, density=c(12, 9), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra utgreiinga", em("Interesse for biologifaget")),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          tags$div(class="topmar", h5("Skole")),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    par(mgp=c(2.5, 0.8, 0), mar=c(2, 3.8, 4, 1))#
#
    barplot(tab, beside=TRUE, cex.names=1.5, cex.lab=1.5, density=c(12, 9), #
      col=c(1, "#27c93a"), ylab="Relativ frekvens")#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, fill=c(1, "#27c93a"),#
      bty="n", cex=1.5, density=c(12, 9), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra utgreiinga Interesse for biologifaget"),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          tags$div(class="topmar", h5("Skole")),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    par(mgp=c(2.5, 0.8, 0), mar=c(2, 3.8, 4, 1))#
#
    barplot(tab, beside=TRUE, cex.names=1.5, cex.lab=1.5, density=c(12, 9), #
      col=c(1, "#27c93a"), ylab="Relativ frekvens")#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, fill=c(1, "#27c93a"),#
      bty="n", cex=1.5, density=c(12, 9), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra utgreiinga", em("Interesse for biologifaget")),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          tags$div(class="topmar", h5("Skole")),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    par(mgp=c(2.5, 0.8, 0), mar=c(2, 3.8, 4, 1))#
#
    barplot(tab, beside=TRUE, cex.names=1.5, cex.lab=1.5, density=c(12, 9), #
      col=c(1, "#27c93a"), ylab="Relativ frekvens")#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, fill=c(1, "#27c93a"),#
      bty="n", cex=1.5, density=c(12, 9), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra utgreiinga", em("Interesse for biologifaget")),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          tags$div(class="topmar", h5("Skole")),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    par(mgp=c(2.5, 0.8, 0), mar=c(2, 3.8, 4, 1))#
#
    barplot(tab, beside=TRUE, cex.names=1.5, cex.lab=1.5, density=c(12, 9), #
      col=c(1, "#27c93a"), ylab="Relativ frekvens")#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, fill=c(1, "#27c93a"),#
      bty="n", cex=1.5, density=c(12, 9), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
val <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev#
}#
#
nam <- function(lev) {#
	lev <- levels(lev)#
	lev <- lev[c(which(lev != 0), which(lev == 0))]#
	lev[lev == 0] <- "NA"#
	lev#
}#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra utgreiinga \"Interesse for biologifaget\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          tags$div(class="topmar", h5("Skole")),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    par(mgp=c(2.5, 0.8, 0), mar=c(2, 3.8, 4, 1))#
#
    barplot(tab, beside=TRUE, cex.names=1.5, cex.lab=1.5, density=c(12, 9), #
      col=c(1, "#27c93a"), ylab="Relativ frekvens")#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, fill=c(1, "#27c93a"),#
      bty="n", cex=1.5, density=c(12, 9), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
source("supp/fun.r")#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra utgreiinga \"Interesse for biologifaget\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          tags$div(class="topmar", h5("Skole")),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    par(mgp=c(2.5, 0.8, 0), mar=c(2, 3.8, 4, 1))#
#
    barplot(tab, beside=TRUE, cex.names=1.5, cex.lab=1.5, density=c(15, 10), #
      col=c(1, "#27c93a"), ylab="Relativ frekvens")#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, fill=c(1, "#27c93a"),#
      bty="n", cex=1.5, density=c(15, 10), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
source("supp/fun.r")#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra utgreiinga \"Interesse for biologifaget\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          tags$div(class="topmar", h5("Skole")),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    par(mgp=c(2.5, 0.8, 0), mar=c(2, 3.8, 4, 1))#
#
    barplot(tab, beside=TRUE, cex.names=1.5, cex.lab=1.5, density=c(15, 10), #
      col=c(1, "#27c93a"), ylab="Relativ frekvens")#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, fill=c(1, "#27c93a"),#
      bty="n", cex=1.6, density=c(15, 10), ncol=2, xpd=NA, inset=-0.15)#
  })#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
source("supp/fun.r")#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra utgreiinga \"Interesse for biologifaget\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          tags$div(class="topmar", h5("Skole")),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    ),#
    textOutput("link")#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    par(mgp=c(2.5, 0.8, 0), mar=c(2, 3.8, 4, 1))#
#
    barplot(tab, beside=TRUE, cex.names=1.5, cex.lab=1.5, density=c(15, 10), #
      col=c(1, "#27c93a"), ylab="Relativ frekvens")#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, fill=c(1, "#27c93a"),#
      bty="n", cex=1.6, density=c(15, 10), ncol=2, xpd=NA, inset=-0.15)#
  })#
  output$link <- renderText("test, test")#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
source("supp/fun.r")#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra utgreiinga \"Interesse for biologifaget\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          tags$div(class="topmar", h5("Skole")),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          )#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    ),#
    fluidRow(textOutput("link"))#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    par(mgp=c(2.5, 0.8, 0), mar=c(2, 3.8, 4, 1))#
#
    barplot(tab, beside=TRUE, cex.names=1.5, cex.lab=1.5, density=c(15, 10), #
      col=c(1, "#27c93a"), ylab="Relativ frekvens")#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, fill=c(1, "#27c93a"),#
      bty="n", cex=1.6, density=c(15, 10), ncol=2, xpd=NA, inset=-0.15)#
  })#
  output$link <- renderText("test, test")#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
source("supp/fun.r")#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra utgreiinga \"Interesse for biologifaget\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          tags$div(class="topmar", h5("Skole")),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          )#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          ),#
          textOutput("link")#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    par(mgp=c(2.5, 0.8, 0), mar=c(2, 3.8, 4, 1))#
#
    barplot(tab, beside=TRUE, cex.names=1.5, cex.lab=1.5, density=c(15, 10), #
      col=c(1, "#27c93a"), ylab="Relativ frekvens")#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, fill=c(1, "#27c93a"),#
      bty="n", cex=1.6, density=c(15, 10), ncol=2, xpd=NA, inset=-0.15)#
  })#
  output$link <- renderText("test, test")#
}#
shinyApp(ui = ui, server = server)
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
source("supp/fun.r")#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra utgreiinga \"Interesse for biologifaget\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          tags$div(class="topmar", h5("Skole")),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          ),#
          helpText(a("Source", href="https://github.com/AkselA/R-Shiny-bioint"))#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          ),#
          helpText(a("Source", href="https://github.com/AkselA/R-Shiny-bioint"))#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    par(mgp=c(2.5, 0.8, 0), mar=c(2, 3.8, 4, 1))#
#
    barplot(tab, beside=TRUE, cex.names=1.5, cex.lab=1.5, density=c(15, 10), #
      col=c(1, "#27c93a"), ylab="Relativ frekvens")#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, fill=c(1, "#27c93a"),#
      bty="n", cex=1.6, density=c(15, 10), ncol=2, xpd=NA, inset=-0.15)#
  })#
  output$link <- renderText("test, test")#
}#
shinyApp(ui = ui, server = server)
helpText
# setwd("~/Documents/R/shiny/bioint")#
library(shiny)#
#
dat <- readRDS("supp/bioint.rds")#
#
source("supp/fun.r")#
#
ui <- fluidPage(#
  includeCSS("supp/styles.css"),#
  titlePanel("Responser fra utgreiinga \"Interesse for biologifaget\""),#
  sidebarLayout(#
    sidebarPanel(#
      tabsetPanel(#
        ####
        tabPanel("Utvalg 1",#
          tags$div(class="topmar", h5("Skole")),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole1",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn1",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse1",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn1",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år1",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd1",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm1", #
            label=NULL, #
            value="1, 3:5, 7, 9"#
          ),#
          helpText(a("Source", href="https://github.com/AkselA/R-Shiny-bioint"))#
        ),#
        ####
        tabPanel("Utvalg 2",#
          h5("Skole"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="skole2",#
              label=NULL,#
              choiceNames=levels(dat$Skole),#
              choiceValues=levels(dat$Skole),#
              selected=levels(dat$Skole),#
              inline=FALSE#
            )#
          ),#
          h5("Trinn"),#
          checkboxGroupInput(inputId="trinn2",#
            label=NULL,#
            choiceNames=levels(dat$Trinn),#
            choiceValues=levels(dat$Trinn),#
            selected=levels(dat$Trinn),#
            inline=TRUE#
          ),#
          h5("Klasse"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="klasse2",#
              label=NULL,#
              choiceNames=levels(dat$Klasse),#
              choiceValues=levels(dat$Klasse),#
              selected=levels(dat$Klasse),#
              inline=FALSE#
            )#
          ),#
          h5("Kjønn"),#
          checkboxGroupInput(inputId="kjønn2",#
            label=NULL,#
            choiceNames=nam(dat$Kj),#
            choiceValues=val(dat$Kj),#
            selected=val(dat$Kj),#
            inline=TRUE#
          ),#
          h5("Fødselsår"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="år2",#
              label=NULL,#
              choiceNames=nam(dat$F.aar),#
              choiceValues=val(dat$F.aar),#
              selected=val(dat$F.aar),#
              inline=FALSE#
            )#
          ),#
          h5("Fødselsmåned"),#
          tags$div(class="multicol", #
            checkboxGroupInput(inputId="mnd2",#
              label=NULL,#
              choiceNames=nam(dat$F.mnd),#
              choiceValues=val(dat$F.mnd),#
              selected=val(dat$F.mnd),#
              inline=FALSE#
            )#
          ),#
          h5("Velg responsvariabler [1, 61]"),#
          textInput(inputId="spm2", #
            label=NULL, #
            value="seq(1, 61, by=2)"#
          ),#
          helpText(a("Source", href="https://github.com/AkselA/R-Shiny-bioint"))#
        )#
      )#
    ),#
    mainPanel(#
        plotOutput("hist", height="550px")#
    )#
  )#
)#
#
server <- function(input, output) {#
  output$hist <- renderPlot({#
    # utvalg 1#
    z <- paste0("c(", input$spm1, ")")#
    z <- eval(parse(text=z))#
    spm1 <- paste0("X", z)#
    sel1 <- dat[#
      dat$Skole %in% c(input$skole1) & #
      dat$Trinn %in% c(input$trinn1) & #
      dat$Klasse %in% c(input$klasse1) & #
      dat$Kj %in% c(input$kjønn1) & #
      dat$F.aar %in% c(input$år1) & #
      dat$F.mnd %in% c(input$mnd1),#
      spm1, drop=FALSE]#
#
    n1 <- nrow(sel1)#
    sel1 <- prop.table(table(unlist(sel1)))#
#
    # utvalg 2#
    z <- paste0("c(", input$spm2, ")")#
    z <- eval(parse(text=z))#
    spm2 <- paste0("X", z)#
    sel2 <- dat[#
      dat$Skole %in% c(input$skole2) & #
      dat$Trinn %in% c(input$trinn2) & #
      dat$Klasse %in% c(input$klasse2) & #
      dat$Kj %in% c(input$kjønn2) & #
      dat$F.aar %in% c(input$år2) & #
      dat$F.mnd %in% c(input$mnd2),#
      spm2, drop=FALSE]#
    n2 <- nrow(sel2)#
    sel2 <- prop.table(table(unlist(sel2)))#
#
    tab <- rbind(sel1, sel2)#
    colnames(tab) <- c("Uinteressert", "Lite interessert", #
                       "Litt interessert", "Veldig interessert")#
    par(mgp=c(2.5, 0.8, 0), mar=c(2, 3.8, 4, 1))#
#
    barplot(tab, beside=TRUE, cex.names=1.5, cex.lab=1.5, density=c(15, 10), #
      col=c(1, "#27c93a"), ylab="Relativ frekvens")#
#
    ltext <- c(paste("Utvalg 1: n =", n1), paste("Utvalg 2: n =", n2))#
    legend("top", legend=ltext, fill=c(1, "#27c93a"),#
      bty="n", cex=1.6, density=c(15, 10), ncol=2, xpd=NA, inset=-0.15)#
  })#
  output$link <- renderText("test, test")#
}#
shinyApp(ui = ui, server = server)
deployApp()
